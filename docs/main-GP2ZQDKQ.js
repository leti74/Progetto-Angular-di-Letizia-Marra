import{b as it,c as M,d as at,e as lt,f as st,g as mt}from"./chunk-NQDR2IZU.js";import{$ as H,Bc as vt,Cc as Ct,Dc as xt,Ea as s,Ec as Mt,Fa as J,Ga as q,Ic as _t,L as N,Mb as ot,Mc as wt,Nb as rt,Nc as w,Ob as nt,Pa as f,Qa as g,R as j,S as z,Sb as ct,Sc as yt,Ta as A,Ua as n,V as T,Va as i,W as u,Wa as m,_ as G,_a as $,ab as v,bb as C,ca as V,cb as Z,db as I,eb as K,fa as B,gb as W,hb as X,hc as R,ic as pt,kb as x,lb as Y,m as O,ma as Q,mb as a,nb as tt,q as P,qa as d,rc as dt,tc as _,ub as et,uc as ut,vc as ft,xc as gt,ya as p,yc as ht,z as F,zc as bt}from"./chunk-STHPKCMU.js";var c=class t{constructor(o,e){this.http=o;this.userService=e}baseURL="https://gorest.co.in/public/v2";userCurrent={name:"Martina Romeo",email:"martina_romeo@crist.example",gender:"female",status:"inactive"};createUserCurrent(){return this.userService.getUserByEmail(this.userCurrent.email).pipe(N(o=>{if(o&&o.length>0){let e=o[0];return console.log("User already exists:",e),localStorage.setItem("user_current",JSON.stringify(e)),O(e)}else return this.userService.addUser(this.userCurrent).pipe(P(e=>(localStorage.setItem("user_current",JSON.stringify(e)),e)))}))}getUserCurrent(){let o=localStorage.getItem("user_current");return o?JSON.parse(o):null}validateToken(o){return this.http.get(`${this.baseURL}/users`,{headers:{Authorization:`Bearer ${o}`}}).pipe(P(e=>(console.log("\u2705 Token valido, risposta:",e),!0)),F(()=>O(!1)))}saveToken(o){localStorage.setItem("access_token",o)}getToken(){return localStorage.getItem("access_token")}logout(){localStorage.removeItem("access_token"),this.isAuthenticated(),localStorage.removeItem("user_current")}isAuthenticated(){return!!this.getToken()}static \u0275fac=function(e){return new(e||t)(T(rt),T(w))};static \u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})};function Rt(t,o){if(t&1&&(n(0,"p",8),a(1),i()),t&2){let e=C();d(),tt(e.errorMsg)}}var y=class t{constructor(o,e,r){this.authService=o;this.router=e;this.userService=r}loginForm;errorMsg="";loading=!1;ngOnInit(){this.loginForm=new bt({token:new vt("",ft.required)})}onLogin(){let o=this.loginForm.value.token;if(!o){this.errorMsg="Please enter a valid token";return}this.loading=!0,this.errorMsg="",this.authService.validateToken(o).subscribe({next:e=>{e?(this.authService.saveToken(o),this.authService.createUserCurrent().subscribe(()=>{this.router.navigate(["users"])})):(this.loading=!1,this.errorMsg="Invalid token. Please check and try again.")},error:()=>{this.loading=!1,this.errorMsg="Invalid token. Please check and try again."}})}static \u0275fac=function(e){return new(e||t)(p(c),p(M),p(w))};static \u0275cmp=s({type:t,selectors:[["app-login-component"]],decls:20,vars:5,consts:[[1,"login-wrapper"],[1,"login-card"],[1,"logo-area"],[1,"subtitle"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","token"],["id","token","type","text","formControlName","token","placeholder","Enter your GoREST token"],[1,"error-text"],["type","submit",1,"btn-primary",3,"disabled"],[1,"token-info"],["href","https://gorest.co.in/consumer/login","target","_blank"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),a(4,"GoREST Portal"),i(),n(5,"p",3),a(6,"Log in with your personal token"),i()(),n(7,"form",4),v("ngSubmit",function(){return r.onLogin()}),n(8,"div",5)(9,"label",6),a(10,"Token:"),i(),m(11,"input",7),f(12,Rt,2,1,"p",8),i(),n(13,"button",9),a(14," Accedi "),i()(),n(15,"div",10)(16,"p"),a(17,"Don't you have a token?"),i(),n(18,"a",11),a(19," Get your token on GoREST \u2192 "),i()()()()),e&2&&(d(7),A("formGroup",r.loginForm),d(4),x("error",r.errorMsg),d(),g(r.errorMsg?12:-1),d(),A("disabled",r.loginForm.invalid))},dependencies:[pt,dt,_,wt,_t,Ct,ut,gt,ht,xt,Mt,mt],styles:[".login-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:90vh;padding-left:1rem;padding-right:1rem}.login-card[_ngcontent-%COMP%]{background:#fff;padding:2.5rem 2rem;border-radius:16px;box-shadow:0 4px 25px #00000014;max-width:420px;width:100%;text-align:center;animation:fadeIn .4s ease-in-out}.logo-area[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:70px;height:auto;margin-bottom:.8rem}.logo-area[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;font-weight:600;color:#0055a5}.subtitle[_ngcontent-%COMP%]{color:#555;font-size:.95rem;margin-bottom:1.5rem;margin-top:.3rem}.form-group[_ngcontent-%COMP%]{text-align:left;margin-bottom:1.5rem}label[_ngcontent-%COMP%]{display:block;font-weight:500;margin-bottom:.4rem;color:#333}input[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:1px solid #d0d4d9;border-radius:8px;font-size:.95rem;transition:all .3s}input[_ngcontent-%COMP%]:focus{border-color:#0055a5;outline:none;box-shadow:0 0 0 3px #0055a526}input.error[_ngcontent-%COMP%]{border-color:#d9534f}.error-text[_ngcontent-%COMP%]{color:#d9534f;font-size:.85rem;margin-top:.4rem}.btn-primary[_ngcontent-%COMP%]{width:100%;background-color:#0055a5;color:#fff;padding:.9rem;border:none;border-radius:8px;font-weight:600;font-size:1rem;cursor:pointer;transition:background-color .25s,transform .1s}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#004080;transform:scale(1.01)}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#9fbad4;cursor:not-allowed}.token-info[_ngcontent-%COMP%]{margin-top:1.5rem;font-size:.9rem;color:#666}.token-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#00aeef;text-decoration:none;font-weight:500}.token-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}@media (max-width: 480px){.login-card[_ngcontent-%COMP%]{padding:2rem 1.2rem}.logo-area[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.4rem}}"]})};var h=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=s({type:t,selectors:[["app-login"]],decls:1,vars:0,template:function(e,r){e&1&&m(0,"app-login-component")},dependencies:[y],encapsulation:2})};var L=(t,o)=>u(c).isAuthenticated();var St=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:h},{path:"users",canActivate:[L],loadComponent:()=>import("./chunk-SEKAGNS2.js").then(t=>t.Users)},{path:"user/:id",loadComponent:()=>import("./chunk-EAYAPTL7.js").then(t=>t.UserDetail)},{path:"posts",canActivate:[L],loadComponent:()=>import("./chunk-YHWHVXJK.js").then(t=>t.Posts)}];var kt={providers:[nt(),B(),et({eventCoalescing:!0}),st(St)]};var Dt=["*",[["mat-toolbar-row"]]],Et=["*","mat-toolbar-row"],Lt=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=q({type:t,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]})}return t})(),Ot=(()=>{class t{_elementRef=u(Q);_platform=u(ct);_document=u(V);color;_toolbarRows;constructor(){}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=s({type:t,selectors:[["mat-toolbar"]],contentQueries:function(r,l,Tt){if(r&1&&K(Tt,Lt,5),r&2){let U;W(U=X())&&(l._toolbarRows=U)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(r,l){r&2&&(Y(l.color?"mat-"+l.color:""),x("mat-toolbar-multiple-rows",l._toolbarRows.length>0)("mat-toolbar-single-row",l._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],ngContentSelectors:Et,decls:2,vars:0,template:function(r,l){r&1&&(Z(Dt),I(0),I(1,1))},styles:[`.mat-toolbar{background:var(--mat-toolbar-container-background-color, var(--mat-sys-surface));color:var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font, var(--mat-sys-title-large-font));font-size:var(--mat-toolbar-title-text-size, var(--mat-sys-title-large-size));line-height:var(--mat-toolbar-title-text-line-height, var(--mat-sys-title-large-line-height));font-weight:var(--mat-toolbar-title-text-weight, var(--mat-sys-title-large-weight));letter-spacing:var(--mat-toolbar-title-text-tracking, var(--mat-sys-title-large-tracking));margin:0}@media(forced-colors: active){.mat-toolbar{outline:solid 1px}}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mat-button-text-label-text-color: var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface));--mat-button-outlined-label-text-color: var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height, 56px)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height, 56px)}}
`],encapsulation:2,changeDetection:0})}return t})();var Pt=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=J({type:t});static \u0275inj=z({imports:[R,R]})}return t})();function Ft(t,o){if(t&1){let e=$();n(0,"mat-toolbar",0)(1,"a",1),a(2,"Logo"),i(),m(3,"span",2),n(4,"div",3)(5,"a",4),a(6,"Users"),i(),n(7,"a",5),a(8,"Posts"),i(),n(9,"button",6),v("click",function(){G(e);let l=C();return H(l.logout())}),a(10,"Logout"),i()()()}}function Nt(t,o){t&1&&(n(0,"mat-toolbar",0)(1,"a",7),a(2,"Login Page"),i()())}var S=class t{constructor(o,e){this.authService=o;this.router=e}logout(){this.authService.logout(),this.router.navigate(["login"])}static \u0275fac=function(e){return new(e||t)(p(c),p(M))};static \u0275cmp=s({type:t,selectors:[["app-header"]],decls:2,vars:1,consts:[[1,"toolbar"],[1,"logo","ml-3"],[1,"example-spacer"],[1,"header-actions"],["routerLink","/users","routerLinkActive","active-link"],["routerLink","/posts","routerLinkActive","active-link"],["routerLink","/login",1,"logout-link",3,"click"],["routerLink","/login",1,"logo","ml-3"]],template:function(e,r){e&1&&f(0,Ft,11,0,"mat-toolbar",0)(1,Nt,3,0,"mat-toolbar",0),e&2&&g(r.authService.isAuthenticated()?0:1)},dependencies:[_,yt,Pt,Ot,at,lt],styles:['.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.toolbar[_ngcontent-%COMP%]{background-color:#06c;color:#fff;padding:0 1.5rem;display:flex;align-items:center;justify-content:space-between;height:64px;font-family:Segoe UI,Open Sans,Roboto,sans-serif;box-shadow:0 2px 4px #0000001a}.header-actions[_ngcontent-%COMP%]{display:flex;gap:1.5rem}.header-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;font-weight:500;font-size:.95rem;position:relative;transition:color .2s ease-in-out}.header-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{cursor:pointer}.header-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-6px;left:0;width:0%;height:2px;background-color:#fff;transition:width .25s ease-in-out}.header-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after, .header-actions[_ngcontent-%COMP%]   a.active-link[_ngcontent-%COMP%]:after{width:100%}.logo[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;letter-spacing:.5px;text-decoration:none;color:#fff;transition:opacity .2s ease-in-out}.logout-link[_ngcontent-%COMP%]{color:#ffe600!important;font-weight:600!important;font-size:.95rem}@media (max-width: 768px){.toolbar[_ngcontent-%COMP%]{flex-wrap:wrap;height:auto;padding:.75rem 1rem}.header-actions[_ngcontent-%COMP%]{width:100%;justify-content:center;flex-wrap:wrap;gap:1rem;margin-top:.5rem;margin-bottom:.5rem}.logo[_ngcontent-%COMP%]{width:100%;text-align:center;margin-bottom:.25rem}}']})};function jt(t,o){t&1&&m(0,"router-outlet")}function zt(t,o){t&1&&m(0,"app-login")}var k=class t{constructor(o){this.authService=o}isSubscribed;ngOnInit(){this.isSubscribed=this.authService.isAuthenticated()}static \u0275fac=function(e){return new(e||t)(p(c))};static \u0275cmp=s({type:t,selectors:[["app-root"]],decls:3,vars:1,template:function(e,r){e&1&&(m(0,"app-header"),f(1,jt,1,0,"router-outlet")(2,zt,1,0,"app-login")),e&2&&(d(),g(r.isSubscribed?1:2))},dependencies:[it,S,h],encapsulation:2})};ot(k,kt).catch(t=>console.error(t));
