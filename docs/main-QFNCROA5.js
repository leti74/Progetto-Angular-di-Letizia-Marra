import{b as lt,c as h,d as st,e as mt,f as ct,g as pt,h as _}from"./chunk-7YYG5JAK.js";import{$ as B,Ac as bt,Cc as vt,Dc as xt,Ec as Ct,Fa as l,Ga as $,Gc as Mt,Ha as W,Hc as _t,Ic as wt,Jc as yt,L as z,Nc as St,Qa as u,Qb as nt,R as G,Ra as f,Rb as it,Rc as kt,S as H,Sb as at,Sc as y,Ua as D,V as R,Va as n,W as g,Wa as i,Wb as dt,Xa as s,Xc as Ot,_ as V,ab as Z,cb as x,da as Q,db as C,eb as K,fb as E,ga as J,gb as X,ib as Y,jb as tt,lc as L,m as T,mb as M,mc as ut,na as q,nb as et,ob as a,pb as ot,q as I,ra as c,wc as ft,xb as rt,xc as gt,yc as w,z as N,za as p,zc as ht}from"./chunk-T5GEWLYA.js";var d=class t{constructor(o,e){this.http=o;this.userService=e}baseURL="https://gorest.co.in/public/v2";userCurrent={name:"Martina Romeo",email:"martina_romeo@crist.example",gender:"female",status:"inactive"};createUserCurrent(){return this.userService.getUserByEmail(this.userCurrent.email).pipe(z(o=>{if(o&&o.length>0){let e=o[0];return console.log("User already exists:",e),localStorage.setItem("user_current",JSON.stringify(e)),T(e)}else return this.userService.addUser(this.userCurrent).pipe(I(e=>(localStorage.setItem("user_current",JSON.stringify(e)),e)))}))}getUserCurrent(){let o=localStorage.getItem("user_current");return o?JSON.parse(o):null}validateToken(o){return this.http.get(`${this.baseURL}/users`,{headers:{Authorization:`Bearer ${o}`}}).pipe(I(e=>(console.log("\u2705 Token valido, risposta:",e),!0)),N(()=>T(!1)))}saveToken(o){localStorage.setItem("access_token",o)}getToken(){return localStorage.getItem("access_token")}logout(){localStorage.removeItem("access_token"),this.isAuthenticated(),localStorage.removeItem("user_current")}isAuthenticated(){return!!this.getToken()}static \u0275fac=function(e){return new(e||t)(R(it),R(y))};static \u0275prov=G({token:t,factory:t.\u0275fac,providedIn:"root"})};function Lt(t,o){if(t&1&&(n(0,"p",8),a(1),i()),t&2){let e=C();c(),ot(e.errorMsg)}}var S=class t{constructor(o,e,r){this.authService=o;this.router=e;this.userService=r}loginForm;errorMsg="";loading=!1;ngOnInit(){this.authService.logout(),this.loginForm=new Ct({token:new Mt("",bt.required)})}onLogin(){let o=this.loginForm.value.token;if(!o){this.errorMsg="Please enter a valid token";return}this.loading=!0,this.errorMsg="",this.authService.validateToken(o).subscribe({next:e=>{e?(this.authService.saveToken(o),this.authService.createUserCurrent().subscribe(()=>{this.router.navigate(["users"])})):(this.loading=!1,this.errorMsg="Invalid token. Please check and try again.")},error:()=>{this.loading=!1,this.errorMsg="Invalid token. Please check and try again."}})}static \u0275fac=function(e){return new(e||t)(p(d),p(h),p(y))};static \u0275cmp=l({type:t,selectors:[["app-login-component"]],decls:20,vars:5,consts:[[1,"login-wrapper"],[1,"login-card"],[1,"logo-area"],[1,"subtitle"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","token"],["id","token","type","text","formControlName","token","placeholder","Enter your GoREST token"],[1,"error-text"],["type","submit",1,"btn-primary",3,"disabled"],[1,"token-info"],["href","https://gorest.co.in/consumer/login","target","_blank"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),a(4,"GoREST Portal"),i(),n(5,"p",3),a(6,"Log in with your personal token"),i()(),n(7,"form",4),x("ngSubmit",function(){return r.onLogin()}),n(8,"div",5)(9,"label",6),a(10,"Token:"),i(),s(11,"input",7),u(12,Lt,2,1,"p",8),i(),n(13,"button",9),a(14," Accedi "),i()(),n(15,"div",10)(16,"p"),a(17,"Don't you have a token?"),i(),n(18,"a",11),a(19," Get your token on GoREST \u2192 "),i()()()()),e&2&&(c(7),D("formGroup",r.loginForm),c(4),M("error",r.errorMsg),c(),f(r.errorMsg?12:-1),c(),D("disabled",r.loginForm.invalid))},dependencies:[ut,ft,w,kt,St,_t,ht,vt,xt,wt,yt,_],styles:[".login-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:90vh;padding-left:1rem;padding-right:1rem}.login-card[_ngcontent-%COMP%]{background:#fff;padding:2.5rem 2rem;border-radius:16px;box-shadow:0 4px 25px #00000014;max-width:420px;width:100%;text-align:center;animation:fadeIn .4s ease-in-out}.logo-area[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:70px;height:auto;margin-bottom:.8rem}.logo-area[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.6rem;font-weight:600;color:#0055a5}.subtitle[_ngcontent-%COMP%]{color:#555;font-size:.95rem;margin-bottom:1.5rem;margin-top:.3rem}.form-group[_ngcontent-%COMP%]{text-align:left;margin-bottom:1.5rem}label[_ngcontent-%COMP%]{display:block;font-weight:500;margin-bottom:.4rem;color:#333}input[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:1px solid #d0d4d9;border-radius:8px;font-size:.95rem;transition:all .3s}input[_ngcontent-%COMP%]:focus{border-color:#0055a5;outline:none;box-shadow:0 0 0 3px #0055a526}input.error[_ngcontent-%COMP%]{border-color:#d9534f}.error-text[_ngcontent-%COMP%]{color:#d9534f;font-size:.85rem;margin-top:.4rem}.btn-primary[_ngcontent-%COMP%]{width:100%;background-color:#0055a5;color:#fff;padding:.9rem;border:none;border-radius:8px;font-weight:600;font-size:1rem;cursor:pointer;transition:background-color .25s,transform .1s}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#004080;transform:scale(1.01)}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#9fbad4;cursor:not-allowed}.token-info[_ngcontent-%COMP%]{margin-top:1.5rem;font-size:.9rem;color:#666}.token-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#00aeef;text-decoration:none;font-weight:500}.token-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}@media (max-width: 480px){.login-card[_ngcontent-%COMP%]{padding:2rem 1.2rem}.logo-area[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.4rem}}"]})};var v=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=l({type:t,selectors:[["app-login"]],decls:1,vars:0,template:function(e,r){e&1&&s(0,"app-login-component")},dependencies:[S],encapsulation:2})};var U=(t,o)=>g(d).isAuthenticated();var At=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:v},{path:"users",canActivate:[U],loadComponent:()=>import("./chunk-6HGAJNTU.js").then(t=>t.Users)},{path:"user/:id",loadComponent:()=>import("./chunk-SBJYN7GQ.js").then(t=>t.UserDetail)},{path:"posts",canActivate:[U],loadComponent:()=>import("./chunk-SOLXXHPT.js").then(t=>t.Posts)}];var Tt={providers:[at(),J(),rt({eventCoalescing:!0}),ct(At,pt())]};var Ft=["*",[["mat-toolbar-row"]]],Ut=["*","mat-toolbar-row"],jt=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=W({type:t,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]})}return t})(),It=(()=>{class t{_elementRef=g(q);_platform=g(dt);_document=g(Q);color;_toolbarRows;constructor(){}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=l({type:t,selectors:[["mat-toolbar"]],contentQueries:function(r,m,Dt){if(r&1&&X(Dt,jt,5),r&2){let j;Y(j=tt())&&(m._toolbarRows=j)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(r,m){r&2&&(et(m.color?"mat-"+m.color:""),M("mat-toolbar-multiple-rows",m._toolbarRows.length>0)("mat-toolbar-single-row",m._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],ngContentSelectors:Ut,decls:2,vars:0,template:function(r,m){r&1&&(K(Ft),E(0),E(1,1))},styles:[`.mat-toolbar{background:var(--mat-toolbar-container-background-color, var(--mat-sys-surface));color:var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font, var(--mat-sys-title-large-font));font-size:var(--mat-toolbar-title-text-size, var(--mat-sys-title-large-size));line-height:var(--mat-toolbar-title-text-line-height, var(--mat-sys-title-large-line-height));font-weight:var(--mat-toolbar-title-text-weight, var(--mat-sys-title-large-weight));letter-spacing:var(--mat-toolbar-title-text-tracking, var(--mat-sys-title-large-tracking));margin:0}@media(forced-colors: active){.mat-toolbar{outline:solid 1px}}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mat-button-text-label-text-color: var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface));--mat-button-outlined-label-text-color: var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height, 56px)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height, 56px)}}
`],encapsulation:2,changeDetection:0})}return t})();var Rt=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=$({type:t});static \u0275inj=H({imports:[L,L]})}return t})();function zt(t,o){if(t&1){let e=Z();n(0,"mat-toolbar",0)(1,"a",1),a(2,"Logo"),i(),s(3,"span",2),n(4,"div",3)(5,"a",4),a(6,"Users"),i(),n(7,"a",5),a(8,"Posts"),i(),n(9,"button",6),x("click",function(){V(e);let m=C();return B(m.logout())}),a(10,"Logout"),i()()()}}var O=class t{constructor(o,e){this.authService=o;this.router=e}logout(){this.authService.logout(),this.router.navigate(["login"])}static \u0275fac=function(e){return new(e||t)(p(d),p(h))};static \u0275cmp=l({type:t,selectors:[["app-header"]],decls:1,vars:1,consts:[[1,"toolbar"],[1,"logo","ml-3"],[1,"example-spacer"],[1,"header-actions"],["routerLink","/users","routerLinkActive","active-link"],["routerLink","/posts","routerLinkActive","active-link"],["routerLink","/login",1,"logout-link",3,"click"]],template:function(e,r){e&1&&u(0,zt,11,0,"mat-toolbar",0),e&2&&f(r.authService.isAuthenticated()?0:-1)},dependencies:[w,Ot,Rt,It,st,mt],styles:['.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.toolbar[_ngcontent-%COMP%]{background-color:#06c;color:#fff;padding:0 1.5rem;display:flex;align-items:center;justify-content:space-between;height:64px;font-family:Segoe UI,Open Sans,Roboto,sans-serif;box-shadow:0 2px 4px #0000001a}.header-actions[_ngcontent-%COMP%]{display:flex;gap:1.5rem}.header-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;font-weight:500;font-size:.95rem;position:relative;transition:color .2s ease-in-out}.header-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{cursor:pointer}.header-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-6px;left:0;width:0%;height:2px;background-color:#fff;transition:width .25s ease-in-out}.header-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after, .header-actions[_ngcontent-%COMP%]   a.active-link[_ngcontent-%COMP%]:after{width:100%}.logo[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;letter-spacing:.5px;text-decoration:none;color:#fff;transition:opacity .2s ease-in-out}.logout-link[_ngcontent-%COMP%]{color:#ffe600!important;font-weight:600!important;font-size:.95rem}@media (max-width: 768px){.toolbar[_ngcontent-%COMP%]{flex-wrap:wrap;height:auto;padding:.75rem 1rem}.header-actions[_ngcontent-%COMP%]{width:100%;justify-content:center;flex-wrap:wrap;gap:1rem;margin-top:.5rem;margin-bottom:.5rem}.logo[_ngcontent-%COMP%]{width:100%;text-align:center;margin-bottom:.25rem}}']})};var P=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=l({type:t,selectors:[["app-footer"]],decls:11,vars:0,consts:[[1,"mt-20","border-t","border-gray-200","bg-white"],[1,"max-w-7xl","mx-auto","px-6","py-8","flex","flex-col","md:flex-row","items-center","justify-between","gap-6"],[1,"text-center","md:text-left"],[1,"text-lg","font-semibold","text-[#0055a5]"],[1,"text-sm","text-gray-400"],[1,"flex","gap-4","md:w-[190px]","md:justify-end"],["href","https://github.com/leti74","target","_blank",1,"p-2","rounded-lg","hover:bg-gray-100","transition"],[1,"text-gray-500","hover:text-[#0055a5]"]],template:function(e,r){e&1&&(n(0,"footer",0)(1,"div",1)(2,"div",2)(3,"h4",3),a(4," User Management App "),i(),n(5,"p",4),a(6," Angular Project \u2013 Letizia Marra "),i()(),n(7,"div",5)(8,"a",6)(9,"mat-icon",7),a(10," code "),i()()()()())},dependencies:[gt],encapsulation:2})};function Gt(t,o){t&1&&s(0,"app-header")}function Ht(t,o){t&1&&s(0,"router-outlet")}function Vt(t,o){t&1&&s(0,"app-login")}function Bt(t,o){t&1&&s(0,"app-footer")}var A=class t{constructor(o,e){this.authService=o;this.router=e;window.addEventListener("pageshow",()=>{this.router.url.includes("login")&&this.authService.logout()})}isSubscribed;ngOnInit(){this.isSubscribed=this.authService.isAuthenticated()}static \u0275fac=function(e){return new(e||t)(p(d),p(h))};static \u0275cmp=l({type:t,selectors:[["app-root"]],decls:4,vars:4,template:function(e,r){e&1&&(u(0,Gt,1,0,"app-header"),u(1,Ht,1,0,"router-outlet"),u(2,Vt,1,0,"app-login"),u(3,Bt,1,0,"app-footer")),e&2&&(f(r.router.url.includes("login")?-1:0),c(),f(r.isSubscribed?1:-1),c(),f(r.isSubscribed?-1:2),c(),f(r.router.url.includes("login")?-1:3))},dependencies:[lt,O,v,P,_],encapsulation:2})};nt(A,Tt).catch(t=>console.error(t));
