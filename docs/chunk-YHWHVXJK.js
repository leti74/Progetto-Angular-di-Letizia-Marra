import{a as U,d as q,e as $,f as z}from"./chunk-U3QEOMXM.js";import{b as H}from"./chunk-THQLEFTJ.js";import"./chunk-RLN6VN4F.js";import{Bc as m,Cc as P,Dc as h,Ea as u,Ec as C,Fc as G,Gc as k,Hc as R,Ic as F,Kb as E,Lc as O,Mc as V,Nc as j,Pa as M,Qa as D,Ra as N,Rc as B,Sa as w,Sc as L,Ta as a,Ua as i,Va as o,Wa as p,ab as c,bb as y,mb as l,nc as A,qa as n,qc as T,rc as I,uc as g,vc as S,xc as v,ya as d,yc as b,zc as x}from"./chunk-STHPKCMU.js";var _=class r{constructor(e){this.dialogRef=e;this.postForm=new x({title:new m("",S.required),body:new m("",S.required)})}postForm;cancel(){this.dialogRef.close()}save(){let e=this.postForm.value.title,t=this.postForm.value.body;this.postForm.valid&&this.dialogRef.close({title:e,body:t})}static \u0275fac=function(t){return new(t||r)(d($))};static \u0275cmp=u({type:r,selectors:[["app-add-poss-dialog"]],decls:16,vars:2,consts:[["mat-dialog-title","",1,"p-4"],[1,"flex","flex-col","gap-3","p-4",3,"formGroup"],["matInput","","formControlName","title","placeholder","Post title"],["matInput","","rows","4","formControlName","body","placeholder","Post content"],[1,"flex","justify-end","gap-2","mt-3"],["mat-stroked-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"]],template:function(t,s){t&1&&(i(0,"h2",0),l(1,"Add new post"),o(),i(2,"form",1)(3,"mat-form-field")(4,"mat-label"),l(5,"Title"),o(),p(6,"input",2),o(),i(7,"mat-form-field")(8,"mat-label"),l(9,"Body"),o(),p(10,"textarea",3),o(),i(11,"div",4)(12,"button",5),c("click",function(){return s.cancel()}),l(13,"Cancel"),o(),i(14,"button",6),c("click",function(){return s.save()}),l(15," Save "),o()()()),t&2&&(n(2),a("formGroup",s.postForm),n(12),a("disabled",s.postForm.invalid))},dependencies:[F,P,g,v,b,h,C,I,T,A,q,V,O,E,L,B],encapsulation:2})};var Y=(r,e)=>e.id;function Z(r,e){if(r&1&&p(0,"app-post-item",9),r&2){let t=y().$implicit;a("post",t)}}function tt(r,e){r&1&&(i(0,"p"),l(1,"No Posts pubblished"),o())}function et(r,e){if(r&1&&M(0,Z,1,1,"app-post-item",9)(1,tt,2,0,"p"),r&2){let t=y();D(t.posts?0:1)}}var J=class r{constructor(e,t){this.usersService=e;this.dialog=t}posts=[];allPosts=[];postsForm;ngOnInit(){this.postsForm=new x({searchText:new m(""),forPage:new m(10)}),this.loadPosts(),this.postsForm.valueChanges.subscribe(()=>{this.applyFilters()})}loadPosts(){this.usersService.getAllPosts().subscribe(e=>{this.posts=e,this.allPosts=e;let t=0;this.posts.forEach(s=>{this.usersService.getCommentsByPost(s.id).subscribe(f=>{s.comments=f,t++}),t===this.posts.length&&this.applyFilters()})})}applyFilters(){let e=this.postsForm.value.searchText?.toLowerCase()||"",t=this.postsForm.value.forPage;this.posts=this.allPosts.filter(s=>s.title.toLowerCase().includes(e)||s.body.toLowerCase().includes(e)).slice(0,t)}addPost(){this.dialog.open(_,{width:"400px"}).afterClosed().subscribe(t=>{t&&this.usersService.addNewPost(t).subscribe(()=>{this.loadPosts()})})}static \u0275fac=function(t){return new(t||r)(d(j),d(z))};static \u0275cmp=u({type:r,selectors:[["app-posts"]],decls:24,vars:5,consts:[[1,"posts-page"],[1,"flex!","flex-wrap!","flex-row!","gap-3!","items-center!","pr-10!","pl-7!","mb-10!",3,"formGroup"],[1,"flex","flex-col","gap-2"],["type","text","formControlName","searchText","placeholder","Title or body",1,"px-4!","py-2!","border!","border-gray-300!","rounded-lg!","outline-0"],["formControlName","forPage",1,"px-4!","py-2!","border!","border-gray-300!","rounded-lg!","outline-0"],[3,"value"],[1,"flex","flex-row","gap-3"],["label","Add Post","icon","note-add",1,"button","mt-7",3,"btnClick"],[1,"flex","flex-col","mt-7","gap-10","px-3"],[3,"post"]],template:function(t,s){t&1&&(i(0,"div",0)(1,"div")(2,"form",1)(3,"div",2)(4,"label"),l(5,"Search post"),o(),p(6,"input",3),o(),i(7,"div",2)(8,"label"),l(9,"Posts per page"),o(),i(10,"select",4)(11,"option",5),l(12,"5"),o(),i(13,"option",5),l(14,"10"),o(),i(15,"option",5),l(16,"25"),o(),i(17,"option",5),l(18,"50"),o()()(),i(19,"div",6)(20,"app-button",7),c("btnClick",function(){return s.addPost()}),o()()(),i(21,"div",8),N(22,et,2,1,null,null,Y),o()()()),t&2&&(n(2),a("formGroup",s.postsForm),n(9),a("value",5),n(2),a("value",10),n(2),a("value",25),n(2),a("value",50),n(5),w(s.posts))},dependencies:[H,F,P,k,R,g,G,v,b,h,C,U],styles:[".posts-page[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:#374151;font-weight:500}.posts-page[_ngcontent-%COMP%]{padding:2.3rem 1.5rem 1.5rem;display:flex;flex-direction:column;gap:1rem}"]})};export{J as Posts};
